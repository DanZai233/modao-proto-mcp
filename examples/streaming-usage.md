# 流式HTML生成使用示例

## 概述

现在你的MCP服务支持流式响应了！这意味着当生成长HTML内容时，你可以看到内容逐步生成，而不是等待整个响应完成。

## 使用方法

### 1. 启用流式响应

在调用 `gen_html` 工具时，设置 `stream: true` 参数：

```json
{
  "name": "gen_html",
  "arguments": {
    "user_input": "创建一个复杂的电商首页，包含导航栏、轮播图、商品列表、页脚等",
    "reference": "参考现代电商网站设计",
    "stream": true
  }
}
```

### 2. 流式响应的优势

- **实时反馈**: 可以看到内容逐步生成
- **更好的用户体验**: 不需要等待整个响应完成
- **适合长内容**: 特别适合生成复杂的HTML页面

### 3. 技术实现

流式响应通过以下方式实现：

1. **HTTP工具类**: 新增了 `postStreamWithFetch` 方法
2. **工具类**: `GenHtmlTool` 新增了 `executeStream` 方法
3. **服务器**: 自动检测流式请求并路由到相应的方法

### 4. 兼容性

- 如果不设置 `stream: true`，仍然使用传统的非流式响应
- 所有现有功能保持不变
- 向后兼容

## 注意事项

1. **MCP协议限制**: 虽然后端支持流式响应，但MCP协议本身不支持流式工具调用结果
2. **内容收集**: 流式内容会在客户端收集完成后一次性返回
3. **错误处理**: 流式执行过程中的错误会被捕获并返回

## 示例响应

使用流式响应时，你会看到类似这样的日志：

```
正在流式生成HTML: "创建一个复杂的电商首页..."
收到流式数据块: <!DOCTYPE html>
收到流式数据块: <html lang="zh-CN">
收到流式数据块: <head>
收到流式数据块:     <meta charset="UTF-8">
收到流式数据块:     <title>电商首页</title>
...
工具 gen_html 流式执行完成
```

## 未来改进

1. **真正的流式MCP**: 等待MCP协议支持流式工具调用
2. **进度指示器**: 添加生成进度显示
3. **部分结果**: 支持返回部分生成的内容
